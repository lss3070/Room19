---
title: "[React] SWR이란"
subtitle: "React"
layout: post
auther: "Hux"
header-style: text
catalog: true
tags:
    Javascript
    HeadlessBrowser
---

개요
---
안녕하세요 React를 이용하여 상태관리 하시는 분들 중에 거의 Redux를 이용하여 상태관리를 해 본적이 있을겁니다.
`SWR"이라는 이름은 HTTP RFC 5861에 의해 알려진 HTTP 캐시 무효 전략인 stale-while-revalidate에서 유래되었습니다. SWR은 먼저 캐시(스태일)로부터 데이터를 반환한 후, fetch 요청(재검증)을 하고, 최종적으로 최신화된 데이터를 가져오는 전략입니다.`

쉽게말해~
왜 사용하는가요??
---
React에서 최상위 컴포넌트에서 가져온 모든 데이터를 유지하고 자식 컴포넌트들에게 값을 전달하고 그 과정에서 서버로부터 가져오는 데이터 수가 많아진다면 관리하기가 힘들어 질 것입니다.
Context API같이 기본적으로 내장되어 있는 기능을 이용하여 전역에서 상태 관리를 할 수 있지만 API호출을 하거나
비동기 호출의 문제는 여전히 존재합니다.

위 문제를 해결하기 위한 많은 라이브러리들이 있지만 저희는 SWR을 이용해서 

hook의 종류

1.useSWR
useSWR은 SWR에서의 기본적인 hook이며 기본 사용방법은 useState를 사용하는 것과 비슷하다.
먼저 아래 예제를 살펴보자.
```tsx
const fetcher = (url) => fetch(url).then((res) => res.json());

import useSWR from 'swr'

const Profile=()=>{
    const {data,error,isValdating}=useSWR('/api/user', fetcher);
    return(
        if(error) <div>failed to load</div>
        if(!data) <div>loading...</div>
        <div>hello {data.name}!</div>
    )
}
```

useSWR은 세개의 state값을 반환합니다.`data`,`error`,`isValidating` 
이 세가지 state값은 각각 독립적으로 운영이 되며 예를 들어 전체 데이~

여러가지 상황에서 useSWR을 사용해보자!

자동 갱신
---
* 인터벌시에 갱신하기



*재연결시에 갱신하기

*갱신 비활성화


내장캐싱기능

```tsx
const App = () => {
  const [data, setData] = useState(null);
  const onClickHandler = async () => {
    const response = await axios.get('/path/getData');
    if (response.status === 200) {
      setData(response.data);
    }
  };
  return <button onClick={() => onClickHandler}/>
}
```
여기서 api호출을 할 때 계속 동일한 api요청을 하게된다면 동일한 값을 가져와 계속 리렌더링을 하게 될것입니다.
이러한 상황은 자원의 낭비를 불러옵니다.
하지만 SWR에서는 깊은 비교를 통하여 값이 바뀌지 않았다면 리렌더링을 트리거 하지 않으며 값 또한 전역 캐시를 사용하여
모든 컴포넌트 사이에 데이터를 저장하고 공유를 합니다.(캐시 수정...)

(compare옵션을 통해 비교함수를 커스터마이징 할 수도 있습니다.)


SWR은 업데이트를 하지 않아도 


상태관리로써의 useSWR
---

```tsx
const useDataSWR=()=>{
    const {data,mutate,error}=useSWR(()=>{
        return state;
    })
}
```


* Suspense

* 미들 웨어


2.useSWRInfinite

페이지 네이션


3.useSWRImmutable




(swr)장점
1. 데이터 캐싱 덕분에 UI가 완벽하게 작동함
2. API 데이터 및 관련 논리를 보유하는 거의 모든 슬라이스를 제거함
3. 데이터 수집에 대해 CRUD 작업을 수행한 수 데이터 재검증 흐름 간소화
4. 새로운 API 종속 기능 개발 가속화??
참고
https://swr.vercel.app
https://dev.to/saisandeepvaddi/simple-way-to-manage-state-in-react-with-context-kig
